三原色と白色からRGB-XYZ変換マトリックスを求める

・含まれるもの
XYZtransform.cpp		本体

・必要なもの
boost


・概要
CIE 1931カラースペースにおいてRGBカラースペースとXYZカラースペースとの相互変換行うための変換マトリックスを求めます


・用途
ICCプロファイルや、PNG画像形式のcHRMチャンクなどで記録されている赤緑青の三原色＋白色（以下、四原色と表記）からXYZカラースペースへの変換をすることができます。またその逆もできます。
変換マトリックスだけを表記しているサイトは多数見かけましたが、微妙に数値が違うこと、そもそも求め方の記したサイトをほとんど見かけなかったことから公開して見ました。


・サンプルについて
サンプルプログラムではsRGBとAdobeRGB、そしてカスタム要素として赤と緑を入れ替えたsRGBのマトリックスを求めています。それぞれ違う結果であることをお確かめください。


・そもそもどうして四原色の値が違うの？
カラーマネージメントにおいて、表示するデバイス、印刷するデバイス、などごとに表示できる色が異なります。これらの差を吸収しできるだけ同じように表現しようとするために、デバイスごとに四原色を定義してあります。
また、画像やドキュメントを作成した環境と同じような色を表現するためにこれらの四原色の定義を画像ファイルなどに埋め込んである場合があります。
現在は四原色の他、さらにもっと詳細な情報を埋め込んである場合もありますが、基本的にCIE 1931カラースペースを介して変換することには変わりありません。


・なんでそんな面倒くさいことするの？
人間の感知できる色にはRGBカラースペースで表現できる色以外のものがあります。RGBの値がマイナスになる場合です。ただマイナスで表記すると色々と不便なのでXYZカラースペースで表したほうが都合がいいのです。


・その他
三元一次連立方程式を求めるのにガウスージョルダン法を用いています。


・参考にしたサイト
Wikipedia
CIE 1931 color space
https://en.wikipedia.org/wiki/CIE_1931_color_space
sRGB
https://en.wikipedia.org/wiki/SRGB

PNG (Portable Network Graphics) Specification, Version 1.2
http://www.libpng.org/pub/png/spec/1.2/PNG-ColorAppendix.html

音と色と数の散歩道
http://www.enjoy.ne.jp/~k-ichikawa/index.html